# Resource Type to File Mapping Configuration
# Edit this file to customize how aztfexport output gets organized
# Patterns are matched using regex against the resource type (e.g., azurerm_virtual_network)

# File organization strategy:
#   - Group related resources together
#   - Keep files focused but not too granular
#   - Separate high-churn resources (NSG rules) from stable ones (VNets)

mappings:
  # ============================================================================
  # COMPUTE
  # ============================================================================
  compute.tf:
    - azurerm_linux_virtual_machine
    - azurerm_windows_virtual_machine
    - azurerm_virtual_machine    # Legacy resource type
    - azurerm_availability_set
    - azurerm_proximity_placement_group
    - azurerm_dedicated_host
    - azurerm_dedicated_host_group
    - azurerm_image
    - azurerm_shared_image
    - azurerm_shared_image_gallery
    - azurerm_shared_image_version
    - azurerm_snapshot
    - azurerm_virtual_machine_scale_set
    - azurerm_linux_virtual_machine_scale_set
    - azurerm_windows_virtual_machine_scale_set

  compute-disks.tf:
    - azurerm_managed_disk
    - azurerm_virtual_machine_data_disk_attachment

  compute-nics.tf:
    - azurerm_network_interface
    - azurerm_network_interface_security_group_association
    - azurerm_network_interface_backend_address_pool_association
    - azurerm_network_interface_nat_rule_association
    - azurerm_network_interface_application_gateway_backend_address_pool_association

  compute-extensions.tf:
    - azurerm_virtual_machine_extension
    - azurerm_virtual_machine_scale_set_extension

  # ============================================================================
  # NETWORKING - Core
  # ============================================================================
  networking.tf:
    - azurerm_virtual_network
    - azurerm_subnet
    - azurerm_public_ip
    - azurerm_public_ip_prefix
    - azurerm_virtual_network_peering
    - azurerm_nat_gateway
    - azurerm_nat_gateway_public_ip_association
    - azurerm_nat_gateway_public_ip_prefix_association
    - azurerm_subnet_nat_gateway_association
    - azurerm_virtual_network_dns_servers
    - azurerm_private_dns_zone
    - azurerm_private_dns_zone_virtual_network_link
    - azurerm_private_dns_a_record
    - azurerm_private_dns_cname_record
    - azurerm_dns_zone
    - azurerm_dns_a_record
    - azurerm_dns_cname_record
    - azurerm_dns_mx_record
    - azurerm_dns_txt_record

  networking-nsgs.tf:
    - azurerm_network_security_group
    - azurerm_network_security_rule
    - azurerm_subnet_network_security_group_association

  networking-routes.tf:
    - azurerm_route_table
    - azurerm_route
    - azurerm_subnet_route_table_association

  networking-lb.tf:
    - azurerm_lb
    - azurerm_lb_backend_address_pool
    - azurerm_lb_probe
    - azurerm_lb_rule
    - azurerm_lb_nat_rule
    - azurerm_lb_nat_pool
    - azurerm_lb_outbound_rule

  networking-appgw.tf:
    - azurerm_application_gateway
    - azurerm_web_application_firewall_policy

  networking-firewall.tf:
    - azurerm_firewall
    - azurerm_firewall_policy
    - azurerm_firewall_policy_rule_collection_group
    - azurerm_firewall_application_rule_collection
    - azurerm_firewall_nat_rule_collection
    - azurerm_firewall_network_rule_collection

  networking-vpn.tf:
    - azurerm_virtual_network_gateway
    - azurerm_virtual_network_gateway_connection
    - azurerm_local_network_gateway
    - azurerm_express_route_circuit
    - azurerm_express_route_circuit_peering
    - azurerm_vpn_gateway
    - azurerm_vpn_site
    - azurerm_vpn_gateway_connection
    - azurerm_point_to_site_vpn_gateway

  networking-bastion.tf:
    - azurerm_bastion_host

  networking-private-endpoint.tf:
    - azurerm_private_endpoint
    - azurerm_private_link_service

  # ============================================================================
  # STORAGE
  # ============================================================================
  storage.tf:
    - azurerm_storage_account
    - azurerm_storage_container
    - azurerm_storage_blob
    - azurerm_storage_share
    - azurerm_storage_queue
    - azurerm_storage_table
    - azurerm_storage_account_network_rules
    - azurerm_storage_management_policy
    - azurerm_storage_account_customer_managed_key

  # ============================================================================
  # DATABASES
  # ============================================================================
  databases-sql.tf:
    - azurerm_mssql_server
    - azurerm_mssql_database
    - azurerm_mssql_elasticpool
    - azurerm_mssql_firewall_rule
    - azurerm_mssql_virtual_network_rule
    - azurerm_mssql_server_transparent_data_encryption
    - azurerm_sql_server     # Legacy
    - azurerm_sql_database   # Legacy

  databases-postgresql.tf:
    - azurerm_postgresql_server
    - azurerm_postgresql_database
    - azurerm_postgresql_firewall_rule
    - azurerm_postgresql_virtual_network_rule
    - azurerm_postgresql_flexible_server
    - azurerm_postgresql_flexible_server_database
    - azurerm_postgresql_flexible_server_firewall_rule

  databases-mysql.tf:
    - azurerm_mysql_server
    - azurerm_mysql_database
    - azurerm_mysql_firewall_rule
    - azurerm_mysql_flexible_server
    - azurerm_mysql_flexible_server_database

  databases-cosmosdb.tf:
    - azurerm_cosmosdb_account
    - azurerm_cosmosdb_sql_database
    - azurerm_cosmosdb_sql_container
    - azurerm_cosmosdb_mongo_database
    - azurerm_cosmosdb_mongo_collection
    - azurerm_cosmosdb_table

  databases-redis.tf:
    - azurerm_redis_cache
    - azurerm_redis_firewall_rule

  # ============================================================================
  # APP SERVICES / WEB
  # ============================================================================
  app-services.tf:
    - azurerm_service_plan
    - azurerm_app_service_plan    # Legacy
    - azurerm_linux_web_app
    - azurerm_windows_web_app
    - azurerm_app_service         # Legacy
    - azurerm_linux_function_app
    - azurerm_windows_function_app
    - azurerm_function_app        # Legacy
    - azurerm_app_service_slot
    - azurerm_app_service_custom_hostname_binding
    - azurerm_app_service_certificate
    - azurerm_app_service_managed_certificate

  # ============================================================================
  # CONTAINERS
  # ============================================================================
  containers-aks.tf:
    - azurerm_kubernetes_cluster
    - azurerm_kubernetes_cluster_node_pool

  containers-acr.tf:
    - azurerm_container_registry
    - azurerm_container_registry_webhook

  containers-aci.tf:
    - azurerm_container_group

  # ============================================================================
  # IDENTITY & ACCESS
  # ============================================================================
  identity.tf:
    - azurerm_user_assigned_identity
    - azurerm_role_assignment
    - azurerm_role_definition

  # ============================================================================
  # KEY VAULT
  # ============================================================================
  keyvault.tf:
    - azurerm_key_vault
    - azurerm_key_vault_access_policy
    - azurerm_key_vault_key
    - azurerm_key_vault_secret
    - azurerm_key_vault_certificate

  # ============================================================================
  # MONITORING & LOGGING
  # ============================================================================
  monitoring.tf:
    - azurerm_log_analytics_workspace
    - azurerm_log_analytics_solution
    - azurerm_application_insights
    - azurerm_monitor_diagnostic_setting
    - azurerm_monitor_action_group
    - azurerm_monitor_metric_alert
    - azurerm_monitor_activity_log_alert
    - azurerm_monitor_log_profile

  # ============================================================================
  # RECOVERY & BACKUP
  # ============================================================================
  backup.tf:
    - azurerm_recovery_services_vault
    - azurerm_backup_policy_vm
    - azurerm_backup_protected_vm
    - azurerm_backup_policy_file_share
    - azurerm_backup_container_storage_account
    - azurerm_backup_protected_file_share
    - azurerm_site_recovery_fabric
    - azurerm_site_recovery_protection_container
    - azurerm_site_recovery_replication_policy

  # ============================================================================
  # RESOURCE GROUPS (usually imported but not managed)
  # ============================================================================
  resource-groups.tf:
    - azurerm_resource_group

  # ============================================================================
  # POLICY & GOVERNANCE
  # ============================================================================
  policy.tf:
    - azurerm_policy_assignment
    - azurerm_policy_definition
    - azurerm_policy_set_definition
    - azurerm_management_lock
    - azurerm_resource_group_policy_assignment
    - azurerm_subscription_policy_assignment

  # ============================================================================
  # AUTOMATION
  # ============================================================================
  automation.tf:
    - azurerm_automation_account
    - azurerm_automation_runbook
    - azurerm_automation_schedule
    - azurerm_automation_job_schedule
    - azurerm_automation_variable_string
    - azurerm_automation_credential

# Default file for any resource type not matched above
default_file: other.tf

# Resource types to skip entirely (won't be included in output)
# Useful for resources you don't want to manage in Terraform
skip_types:
  # - azurerm_resource_group  # Uncomment if you don't want to manage RGs
  # - azurerm_role_assignment # Uncomment if RBAC is managed elsewhere
